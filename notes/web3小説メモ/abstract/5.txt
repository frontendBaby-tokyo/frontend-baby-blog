第5話の要約

ストーリー概要

ハードウェアウォレットの設定を終えた主人公は、D氏から「スマートコントラクトの検証」について学ぶため、秋葉原のカフェで再会する。事前に指示されていた通り、主人公は人気のDeFiプロジェクトのスマートコントラクトを選んでいた。

D氏は「Verifiedマークがあるだけで安心するな」と警告し、「みんなが使っているから安全」という考えは「中央集権的な盲信」だと批判する。彼によれば：

スマートコントラクトはWEB3.0の心臓だが、正しく動く保証はない
Etherscanの「Verified」マークは単なる飾りで、バイトコードと一致しているか自分で確認すべき
コミュニティを信頼するのではなく、「コードだけが事実」と考えるべき
D氏はコントラクトのソースコードをダウンロードし、Solidityコンパイラを自分でソースからビルドして検証を始める。彼は主人公に再入攻撃の概念を説明し、コード内の対策（nonReentrant修飾子）を確認させる。

さらに、D氏は主人公に課題として「このコントラクトに10ETHを預けるとしてリスクを洗い出せ」と指示。主人公は以下の問題点を発見する：

withdraw関数のガス代が異常に高く、DoS攻撃の可能性
外部ライブラリのバージョンが古く、既知の脆弱性が修正されていない
オーナーがアップグレード可能なプロキシパターンを使用しており、ロジックを変更可能
驚くべきことに、D氏は主人公が選んだコントラクトが「今朝ハッキングされた」と告げる。オーナーがプロキシを使って不正なロジックに切り替え、全資金を抜いたという。これにより主人公はD氏の警戒心の意味を実感する。

D氏は「スマートコントラクトは魔法ではなく人間が書いたコード」であり、「自分の目で確かめたコードだけが真実」と強調。次回はDeFiの罠について教えると告げ、USBメモリを主人公に手渡す。

主人公は帰宅後、コントラクトコードを再度確認し、「コードの中の『死角』を見つける目を養わなければならない」と決意する。