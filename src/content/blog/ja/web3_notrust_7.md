---
description: 連載「信頼ゼロ社会を生きるWEB3.0原理主義エンジニアの奇妙すぎる日常に翻弄される僕 ～フルノードを立てなきゃDAppも使えません！」
pubDate: 2025-08-10T00:00:00.000Z
recommended: false
tags:
  - tags.genre.tech-light-novel
  - tags.tech.web3
title: 第7話 「分散型取引所の闇」 
---

## 信頼ゼロ社会を生きるWEB3.0原理主義エンジニアの奇妙すぎる日常に翻弄される僕 ～フルノードを立てなきゃDAppも使えません！

### 注

この物語は、WEB3.0の世界を楽しく学ぶことを目的に、生成AIを活用して執筆されています。
技術的な情報の正確性には細心の注意を払っていますが、その内容がすべて真実であることを保証するものではありません。
あくまで学習の補助ツールとして、肩の力を抜いてお楽しみください。

---

### 登場人物紹介

*   **私:** DTPオペレータからエンジニアに転職したばかりの新米開発者
*   **D氏:** 40代半ば、極度の警戒心を持つWEB3.0原理主義者

---

### 第7話 「分散型取引所の闇」 

D氏から受け取った「MEV防御デバイス」を手に、私は自宅でスマートコントラクトの検証作業に没頭していた。前回のDeFiプロトコルのラグプル事件は、暗号資産界隈で大きなニュースになっていた。Twitterでは被害者の怒りの声が溢れ、「30%の利回りに騙された」「全財産を失った」という悲痛な叫びが並ぶ。

「あれに投資していたら...」

思わず背筋が凍る。D氏の警告を聞いていなければ、私も被害者の一人になっていたかもしれない。彼の極端な警戒心を笑っていた自分が、今は恥ずかしく思える。

スマートフォンが震えた。D氏からの暗号化されたメッセージだ。

分散型取引所について話す。
明日18時、秋葉原電気街。
今回は場所を変える。監視の目が多すぎる。
座標: [暗号化された位置情報]
返信不要。来るなら来い。

メッセージの最後には、「このメッセージは30秒後に自動消去される」という注意書きがあった。冗談かと思ったが、本当に30秒後、メッセージは画面から消えた。

翌日、指定された時間に秋葉原に到着した。D氏から送られた暗号化された位置情報を解読すると、それは古いビルの一室を指していた。雑居ビルの階段を上り、指定された部屋の前に立つと、ドアには何の表示もない。

ノックすると、中から「パスフレーズを言え」という声が聞こえた。

「え？パスフレーズ？」

「冗談だ。入れ」

ドアが開き、D氏が現れた。彼はいつもの黒いジャケットではなく、派手なアロハシャツを着ていた。変装だろうか。

「遅れていない。良い」

部屋に入ると、そこは想像を超える光景だった。壁一面がファラデーケージで覆われ、天井からは奇妙なアンテナ状の装置が吊るされている。壁一面に並ぶモニター群、複数のサーバーラック、そして中央に置かれた巨大な作業台。まるでハリウッド映画に出てくるハッカーの秘密基地のようだ。

「ここは？」

「DEX監視ステーションだ」D氏は誇らしげに言った。「ここは信頼できる仲間だけが知る場所。中央集権的な監視の目が届かない」

彼は壁を叩いた。「ファラデーケージだ。政府の盗聴器は電磁波を発する。ここでは完全に遮断している」

部屋の隅では、見知らぬ男性が複数のモニターを前に作業していた。

「彼はK。詳細は不要だ」

Kと呼ばれた男性は振り向きもせず、手を軽く上げただけだった。

「この部屋に入る前に、スマートフォンのバッテリーを外したか？」D氏が突然尋ねた。

「え？いいえ...」

D氏は呆れた表情で小さな金属製の箱を差し出した。「すぐに入れろ。電源オフでも位置情報は送信される。バッテリーを物理的に取り外すか、この電磁波遮断ボックスに入れるしかない」

私が従うと、彼は続けた。「靴底もチェックしろ。GPSトラッカーが埋め込まれている可能性がある。特に新しい靴は要注意だ」

私は半信半疑で靴底を確認した。もちろん、何も見つからなかった。

D氏のバックパックが開き、中身が少し見えた。そこには驚くべきものが詰まっていた。電磁波遮断布で包まれたハードウェアウォレット複数、自作の空気品質測定器、放射線検出器、複数のバーナーフォン、種子保存用の防水ケース、そして「緊急脱出計画」と書かれた封筒。

「何を見ている？」D氏は鋭く言った。「これは生存キットだ。デジタル世界だけでなく、物理世界の崩壊にも備えている。君も用意すべきだ」

D氏は中央の作業台に私を案内した。そこには複数のモニターと、見たこともない自作のハードウェア機器が並んでいる。

「今日は分散型取引所の闇について教える」

彼はキーボードを叩き、画面に複数のチャートとコードを表示させた。

「だが、その前に小テストだ」D氏は突然宣言した。

彼は一連の暗号化された質問を表示し、タイマーをセットした。「制限時間は3分」

問題は驚くほど専門的だった。「イーサリアムのマークルパトリシアツリーの深さは？」「EIP-1559実装後のガス料金計算式は？」「フラッシュローンの最大借入可能額を決める要素は？」

私が苦戦していると、D氏は冷静に言った。「基礎知識がなければ、DEXの世界で生き残れない。これが分からなければ、MEVハンターの餌食だ」

テストが終わると、D氏は私のスコアを厳しく評価した。「60点。合格最低ラインだ。次回までに80点を目指せ」

彼は分厚い資料を渡した。「これを暗記しろ。命を守るための知識だ」

「まず基本から。分散型取引所とは何か？」

「えっと...中央集権的な管理者なしに、スマートコントラクトを通じて暗号資産の交換ができるプラットフォームですよね？」

「概ね正しい」D氏はうなずいた。「だが、『分散型』という言葉に騙されるな。多くのDEXは、見えない形で中央集権的な要素を持っている」

彼は画面に自動マーケットメーカー（AMM）の仕組みを表示した。

「DEXの基本原理は単純だ。流動性プールと呼ばれる資金プールがあり、x×y=kという数式に基づいて価格が決まる。ユーザーがトークンをスワップすると、プール内の比率が変わり、価格が変動する」

D氏は続けた。「中央集権型取引所との最大の違いは、注文板の有無だ。DEXには伝統的な注文板がなく、全てがアルゴリズムで自動的に処理される」

私はメモを取りながら聞いていた。D氏の説明は難解だが、いつも核心を突いている。

「では、DEXの危険性について話そう」

彼は新しい画面を表示した。そこには「フロントランニング」「サンドイッチ攻撃」「MEV」といった言葉が並んでいる。

「これらは全て、ブロックチェーンの透明性を悪用した攻撃だ。例えば、フロントランニングとは何か分かるか？」

「取引の前に同じような取引を行って利益を得る...みたいなものですか？」

「その通り」D氏は珍しく私を褒めた。「君の取引がメモプールに入ると、それは全世界に公開される。悪意のある者は、その情報を見て、君の取引の前に同じ取引を行い、価格を操作して利益を得る」

彼は続けて「サンドイッチ攻撃」を説明した。これは取引の前後に攻撃者が取引を挟み込み、価格を操作して利益を得る手法だ。

「そして最も深刻なのがMEV、Miner Extractable Valueだ」

D氏は自作の「MEVスキャナー」と呼ぶデバイスを起動した。画面には、リアルタイムでブロックチェーン上の取引が可視化されている。

「これを見ろ」

彼が指さした画面では、ある大きな取引が行われようとしていた。その直前と直後に、小さな取引が挿入されている。

「これがサンドイッチ攻撃だ。今、目の前で起きている」

私は息を呑んだ。教科書的な説明ではなく、実際に起きている攻撃を目の当たりにしている。

「この攻撃で、元の取引者は約0.5ETH分の損失を被った」D氏は冷静に分析した。「彼はスリッページ設定を1%にしていたからだ。愚かな設定だ」

「スリッページって何ですか？」

「取引実行時に許容する価格変動の幅だ」D氏は真剣な表情で言った。「スリッページ設定は命を守るパラメータだ。1%以上に設定するのは、家の鍵を開けたまま外出するようなものだ」

彼は自分の取引設定を見せた。スリッページは0.1%に設定されている。

「理想は0.1%だ。それ以上は論外。取引が失敗しても、資産を失うよりマシだ」

D氏は続けて、安全なDEX利用のための対策を教えてくれた。

「まず、プライベートメモプールを利用しろ。Flashbotsのような仕組みだ。これにより、取引がパブリックメモプールに公開されず、MEV攻撃のリスクを減らせる」

彼はキーボードを叩き、コードを表示した。

「次に、取引タイミングの選定だ。ガス価格が低く、ネットワーク混雑が少ない時間帯を狙え。具体的には、アメリカが寝ている時間帯だ」

D氏は自作の「MEV防御システム」も紹介してくれた。これは取引を複数の小さな取引に分割し、ランダムな時間間隔で実行するシステムだ。

「大きな取引ほど、MEVハンターの標的になる。分割して目立たなくするんだ」

彼の説明は続いた。「分散型取引所は、中央集権型取引所よりマシというだけで、決して安全ではない。むしろ、見えない敵と戦うことになる」

「DEXを使う前に、プライバシー対策が必要だ」

D氏は複数のVPNを経由し、Torブラウザを起動。さらに仮想マシン内の別の仮想マシンでブラウザを開くという入れ子構造のセキュリティを構築した。

「これでも不十分だ」彼は真剣な表情で言い、USBから起動する独自OSを挿入。「これは自作のセキュアOS。カーネルから全て書き直した」

起動には3段階の認証と、奇妙な儀式のような一連の操作が必要だった。

私は半ば呆れ、半ば感心しながら彼の一連の行動を見ていた。

「これが標準的なセキュリティプロトコルだ」D氏は当然のように言った。「君も習慣にすべきだ」

作業の合間、D氏は珍しく自分の過去について語り始めた。

「実は...私はかつて大手取引所でセキュリティエンジニアとして働いていた」

私は驚いて彼を見た。D氏が過去について話すのは初めてだった。

「そこで目にした内部操作と不正に耐えられなかった。取引所は顧客の資産を自由に操作し、価格操作も日常茶飯事だった。それが私がWEB3.0の世界に身を投じた理由だ」

彼の表情は硬く、過去の記憶と向き合うのが辛そうだった。

「だが、WEB3.0の世界も完璧ではない。むしろ、新たな形の中央集権化が進んでいる。MEVはその一例だ」

D氏は深いため息をついた。「私が極端だと思うか？極端なのは、自分の資産を守るための知識もなく、見知らぬ人間の作ったコードに盲目的に信頼を寄せる大衆の方だ」

彼の言葉には重みがあった。極端な警戒心の裏には、実体験に基づく深い理由があったのだ。

「さて、最後に重要なことを教える」

D氏は新しいリストを表示した。「これは『絶対に使ってはいけないDEX』のリストだ」

驚いたことに、そのリストには業界で最も人気のあるDEXも含まれていた。

「なぜですか？これらは有名なプロジェクトですよね？」

「有名だからこそ危険だ」D氏は断言した。「理由は様々だ。バックドアが仕込まれている、開発者キーが単一のマルチシグウォレットに集中している、コードの一部が非公開...」

彼は特に人気のあるDEXのコードを表示し、問題点を指摘した。

「ここを見ろ。このコントラクトには『緊急停止機能』がある。開発者が『緊急時』と判断すれば、全ての取引を停止できる。これは中央集権的な権力そのものだ」

私は衝撃を受けた。多くのユーザーが信頼しているプラットフォームに、そんな問題があるとは。

「では、どのDEXなら安全なんですか？」

D氏は小さなリストを見せた。「これらは比較的信頼できる。だが、100%安全なものはない。常に自分で検証しろ」

彼は最後に、自作の「DEX評価システム」を紹介してくれた。これは各DEXのコード、ガバナンス構造、開発者の分布などを分析し、リスクスコアを算出するシステムだ。

「これを使え。だが、盲信するな。あくまで参考程度に」

帰り際、D氏は私に小さなUSBメモリを手渡した。

「次回はNFTの真実について教える。このUSBには予習資料が入っている」

彼は真剣な表情で付け加えた。「だが、このUSBを開く前に、必ずオフラインの環境で、自作のサンドボックスシステムを使え。市販のウイルス対策ソフトは信用するな。彼らは全てのデータを中央サーバーに送信している」

私は苦笑しながらUSBを受け取った。D氏の極端な警戒心は時に滑稽だが、彼の言葉には常に一理ある。それが彼の言葉に重みを与えている。

「あと、このUSBを開く前に、3回連続で電子レンジで10秒間加熱しろ」

「え？それって壊れませんか？」

「冗談だ」D氏は珍しく口元を緩めた。「だが、本気で言っていると思ったなら、君はまだ学ぶべきことが多い」

帰り道、私はD氏から学んだことを振り返っていた。「見えない戦場で戦うには、見えない武器が必要だ」という彼の言葉が頭に残る。

DEXの世界は、表面上は「分散型」を謳いながら、実は新たな形の中央集権化や不平等が存在する場所だった。それを見抜き、対策を講じるには、深い知識と警戒心が必要だ。

私は決意した。自分でもMEV防御システムを作ってみよう。D氏の教えを実践に移す時だ。

自宅に戻り、ノートPCを開く。D氏から教わったコードを参考に、自分なりのMEV防御システムの設計を始めた。画面に映るコードは、まるで新しい言語を学ぶような挑戦だが、一歩一歩進むしかない。

USBを手に取り、D氏の言葉を思い出す。「NFTの真実」とは何だろう？彼が言う「本物のNFT」とは？次回の講義が今から待ち遠しい。

---

### **豆知識**
**MEV (Miner Extractable Value)**
ブロックチェーンのトランザクション順序を操作することで得られる利益のこと。イーサリアムのようなブロックチェーンでは、マイナー（現在はバリデーター）がトランザクションの順序を決定できるため、この権限を利用して利益を得ることができます。例えば、大きな取引の前後に自分の取引を挟み込む「サンドイッチ攻撃」などがあります。MEVは年間数十億ドル規模の市場と言われています。

**フロントランニング (Front-running)**
他のユーザーの保留中のトランザクションを見て、より高いガス料金で同様のトランザクションを送信し、先に処理させる攻撃手法。例えば、誰かが安い価格でトークンを購入しようとしているのを見て、先に同じトークンを購入し、価格を上昇させた後に売却して利益を得るといった方法です。

**プライベートメモプール (Private Mempool)**
通常、トランザクションはパブリックメモプール（未確認トランザクションの待機場所）に送信され、誰でも見ることができます。プライベートメモプールは、トランザクションをマイナー/バリデーターに直接送信する仕組みで、MEV攻撃のリスクを軽減します。Flashbotsなどのサービスがこれを提供しています。

### **次回予告　「第8話：NFTの真実」**  
「デジタル所有権革命」と謳われるNFT。しかしD氏によれば「ほとんどのNFTプロジェクトは詐欺か無知の産物だ」。メタデータの脆弱性、IPFSの誤解、「オフチェーン」と「オンチェーン」の違い...。D氏が暴くNFTの真実とは？そして、彼が密かに収集している「本物のNFTアート」の驚くべき正体とは...？

---
*第7話 おわり*