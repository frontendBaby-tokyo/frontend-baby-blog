---
import { siteConfig } from '@/data/site.config'

// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨€èªã¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹è¨€èª
const defaultLang = 'ja'
const supportedLangs = ['ja', 'en']
---

<!doctype html>
<html lang='ja'>
	<head>
		<meta charset='UTF-8' />
		<meta name='viewport' content='width=device-width, initial-scale=1.0' />
		<title>Redirecting... - {siteConfig.title}</title>
		<meta name='description' content='Redirecting to the appropriate language version' />

		<!-- SEO: æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ -->
		<meta name='robots' content='noindex, nofollow' />

		<!-- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èªã¸ã®canonical -->
		<link rel='canonical' href={`${siteConfig.site}/${defaultLang}`} />

		<!-- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®ãƒ¡ã‚¿ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆ1ç§’å¾Œï¼‰ -->
		<meta http-equiv='refresh' content={`1;url=${siteConfig.site}/${defaultLang}`} />

		<!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ -->
		<link rel='icon' type='image/svg+xml' href='/favicon.svg' />

		<style>
			body {
				font-family:
					system-ui,
					-apple-system,
					sans-serif;
				margin: 0;
				padding: 2rem;
				min-height: 100vh;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				text-align: center;
			}

			.container {
				max-width: 500px;
				padding: 2rem;
				background: rgba(255, 255, 255, 0.1);
				border-radius: 12px;
				backdrop-filter: blur(10px);
				box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
			}

			h1 {
				margin: 0 0 1rem 0;
				font-size: 1.5rem;
				font-weight: 600;
			}

			p {
				margin: 0 0 1.5rem 0;
				opacity: 0.9;
			}

			.links {
				display: flex;
				gap: 1rem;
				justify-content: center;
				flex-wrap: wrap;
			}

			.link {
				display: inline-block;
				padding: 0.75rem 1.5rem;
				background: rgba(255, 255, 255, 0.2);
				color: white;
				text-decoration: none;
				border-radius: 8px;
				font-weight: 500;
				transition: all 0.2s ease;
				border: 1px solid rgba(255, 255, 255, 0.3);
			}

			.link:hover {
				background: rgba(255, 255, 255, 0.3);
				transform: translateY(-2px);
			}

			.spinner {
				display: inline-block;
				width: 20px;
				height: 20px;
				border: 2px solid rgba(255, 255, 255, 0.3);
				border-radius: 50%;
				border-top-color: white;
				animation: spin 0.8s ease-in-out infinite;
				margin-right: 0.5rem;
			}

			@keyframes spin {
				to {
					transform: rotate(360deg);
				}
			}

			.hidden {
				display: none;
			}
		</style>
	</head>
	<body>
		<div class='container'>
			<h1>
				<span class='spinner'></span>
				ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¦ã„ã¾ã™...
			</h1>
			<p>
				é©åˆ‡ãªè¨€èªãƒšãƒ¼ã‚¸ã«ç§»å‹•ä¸­ã§ã™ã€‚è‡ªå‹•ã§ç§»å‹•ã—ãªã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
			</p>

			<div class='links'>
				<a href={`${import.meta.env.BASE_URL}/ja`} class='link'>ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</a>
				<a href={`${import.meta.env.BASE_URL}/en`} class='link'>ğŸ‡ºğŸ‡¸ English</a>
			</div>
		</div>

		<script define:vars={{ basePath: import.meta.env.BASE_URL }}>
			// ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨€èªè¨­å®šã‚’å–å¾—
			function detectLanguage() {
				const supportedLangs = ['ja', 'en']
				const defaultLang = 'ja'

				// navigator.languageã¾ãŸã¯navigator.languagesã‹ã‚‰è¨€èªã‚’å–å¾—
				const browserLangs = navigator.languages || [navigator.language]

				// ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨€èªè¨­å®šã‚’ãƒã‚§ãƒƒã‚¯
				for (const browserLang of browserLangs) {
					const lang = browserLang.toLowerCase().split('-')[0] // 'ja-JP' -> 'ja'
					if (supportedLangs.includes(lang)) {
						return lang
					}
				}

				return defaultLang
			}

			// å³åº§ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå®Ÿè¡Œ
			function redirect() {
				const targetLang = detectLanguage()
				const targetUrl = `${basePath}/${targetLang}`

				// 0.1ç§’å¾Œã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆUXã‚’è€ƒæ…®ã—ãŸæœ€å°é™ã®é…å»¶ï¼‰
				setTimeout(() => {
					window.location.href = targetUrl
				}, 100)
			}

			// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«å®Ÿè¡Œ
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', redirect)
			} else {
				redirect()
			}

			// ãƒ‡ãƒãƒƒã‚°æƒ…å ±ï¼ˆé–‹ç™ºæ™‚ã®ã¿ï¼‰
			console.log('Browser languages:', navigator.languages)
			console.log('Detected language:', detectLanguage())
		</script>
	</body>
</html>
